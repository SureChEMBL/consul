Description: Modify test fixture paths
 The Debian packging process executes Go tests in a subdirectory
 which is not handled correctly.  The path to each test fixture
 file has been updated to reflect this.
Author: Tim Potter <tpot@hpe.com>
Forwarded: no
---
This patch header follows DEP-3: http://dep.debian.net/deps/dep3/
Index: consul/tlsutil/config_test.go
===================================================================
--- consul.orig/tlsutil/config_test.go
+++ consul/tlsutil/config_test.go
@@ -25,7 +25,7 @@ func TestConfig_AppendCA_None(t *testing
 
 func TestConfig_CACertificate_Valid(t *testing.T) {
 	conf := &Config{
-		CAFile: "../test/ca/root.cer",
+		CAFile: "../../../../../../test/ca/root.cer",
 	}
 	pool := x509.NewCertPool()
 	err := conf.AppendCA(pool)
@@ -50,8 +50,8 @@ func TestConfig_KeyPair_None(t *testing.
 
 func TestConfig_KeyPair_Valid(t *testing.T) {
 	conf := &Config{
-		CertFile: "../test/key/ourdomain.cer",
-		KeyFile:  "../test/key/ourdomain.key",
+		CertFile: "../../../../../../test/key/ourdomain.cer",
+		KeyFile:  "../../../../../../test/key/ourdomain.key",
 	}
 	cert, err := conf.KeyPair()
 	if err != nil {
@@ -77,7 +77,7 @@ func TestConfig_OutgoingTLS_MissingCA(t
 
 func TestConfig_OutgoingTLS_OnlyCA(t *testing.T) {
 	conf := &Config{
-		CAFile: "../test/ca/root.cer",
+		CAFile: "../../../../../../test/ca/root.cer",
 	}
 	tls, err := conf.OutgoingTLSConfig()
 	if err != nil {
@@ -91,7 +91,7 @@ func TestConfig_OutgoingTLS_OnlyCA(t *te
 func TestConfig_OutgoingTLS_VerifyOutgoing(t *testing.T) {
 	conf := &Config{
 		VerifyOutgoing: true,
-		CAFile:         "../test/ca/root.cer",
+		CAFile:         "../../../../../../test/ca/root.cer",
 	}
 	tls, err := conf.OutgoingTLSConfig()
 	if err != nil {
@@ -114,7 +114,7 @@ func TestConfig_OutgoingTLS_VerifyOutgoi
 func TestConfig_OutgoingTLS_ServerName(t *testing.T) {
 	conf := &Config{
 		VerifyOutgoing: true,
-		CAFile:         "../test/ca/root.cer",
+		CAFile:         "../../../../../../test/ca/root.cer",
 		ServerName:     "consul.example.com",
 	}
 	tls, err := conf.OutgoingTLSConfig()
@@ -138,7 +138,7 @@ func TestConfig_OutgoingTLS_ServerName(t
 func TestConfig_OutgoingTLS_VerifyHostname(t *testing.T) {
 	conf := &Config{
 		VerifyServerHostname: true,
-		CAFile:               "../test/ca/root.cer",
+		CAFile:               "../../../../../../test/ca/root.cer",
 	}
 	tls, err := conf.OutgoingTLSConfig()
 	if err != nil {
@@ -161,9 +161,9 @@ func TestConfig_OutgoingTLS_VerifyHostna
 func TestConfig_OutgoingTLS_WithKeyPair(t *testing.T) {
 	conf := &Config{
 		VerifyOutgoing: true,
-		CAFile:         "../test/ca/root.cer",
-		CertFile:       "../test/key/ourdomain.cer",
-		KeyFile:        "../test/key/ourdomain.key",
+		CAFile:         "../../../../../../test/ca/root.cer",
+		CertFile:       "../../../../../../test/key/ourdomain.cer",
+		KeyFile:        "../../../../../../test/key/ourdomain.key",
 	}
 	tls, err := conf.OutgoingTLSConfig()
 	if err != nil {
@@ -221,9 +221,9 @@ func startTLSServer(config *Config) (net
 
 func TestConfig_outgoingWrapper_OK(t *testing.T) {
 	config := &Config{
-		CAFile:               "../test/hostname/CertAuth.crt",
-		CertFile:             "../test/hostname/Alice.crt",
-		KeyFile:              "../test/hostname/Alice.key",
+		CAFile:               "../../../../../../test/hostname/CertAuth.crt",
+		CertFile:             "../../../../../../test/hostname/Alice.crt",
+		KeyFile:              "../../../../../../test/hostname/Alice.key",
 		VerifyServerHostname: true,
 		Domain:               "consul",
 	}
@@ -255,9 +255,9 @@ func TestConfig_outgoingWrapper_OK(t *te
 
 func TestConfig_outgoingWrapper_BadDC(t *testing.T) {
 	config := &Config{
-		CAFile:               "../test/hostname/CertAuth.crt",
-		CertFile:             "../test/hostname/Alice.crt",
-		KeyFile:              "../test/hostname/Alice.key",
+		CAFile:               "../../../../../../test/hostname/CertAuth.crt",
+		CertFile:             "../../../../../../test/hostname/Alice.crt",
+		KeyFile:              "../../../../../../test/hostname/Alice.key",
 		VerifyServerHostname: true,
 		Domain:               "consul",
 	}
@@ -288,9 +288,9 @@ func TestConfig_outgoingWrapper_BadDC(t
 
 func TestConfig_outgoingWrapper_BadCert(t *testing.T) {
 	config := &Config{
-		CAFile:               "../test/ca/root.cer",
-		CertFile:             "../test/key/ourdomain.cer",
-		KeyFile:              "../test/key/ourdomain.key",
+		CAFile:               "../../../../../../test/ca/root.cer",
+		CertFile:             "../../../../../../test/key/ourdomain.cer",
+		KeyFile:              "../../../../../../test/key/ourdomain.key",
 		VerifyServerHostname: true,
 		Domain:               "consul",
 	}
@@ -321,9 +321,9 @@ func TestConfig_outgoingWrapper_BadCert(
 
 func TestConfig_wrapTLS_OK(t *testing.T) {
 	config := &Config{
-		CAFile:         "../test/ca/root.cer",
-		CertFile:       "../test/key/ourdomain.cer",
-		KeyFile:        "../test/key/ourdomain.key",
+		CAFile:         "../../../../../../test/ca/root.cer",
+		CertFile:       "../../../../../../test/key/ourdomain.cer",
+		KeyFile:        "../../../../../../test/key/ourdomain.key",
 		VerifyOutgoing: true,
 	}
 
@@ -351,8 +351,8 @@ func TestConfig_wrapTLS_OK(t *testing.T)
 
 func TestConfig_wrapTLS_BadCert(t *testing.T) {
 	serverConfig := &Config{
-		CertFile: "../test/key/ssl-cert-snakeoil.pem",
-		KeyFile:  "../test/key/ssl-cert-snakeoil.key",
+		CertFile: "../../../../../../test/key/ssl-cert-snakeoil.pem",
+		KeyFile:  "../../../../../../test/key/ssl-cert-snakeoil.key",
 	}
 
 	client, errc := startTLSServer(serverConfig)
@@ -361,7 +361,7 @@ func TestConfig_wrapTLS_BadCert(t *testi
 	}
 
 	clientConfig := &Config{
-		CAFile:         "../test/ca/root.cer",
+		CAFile:         "../../../../../../test/ca/root.cer",
 		VerifyOutgoing: true,
 	}
 
@@ -387,9 +387,9 @@ func TestConfig_wrapTLS_BadCert(t *testi
 func TestConfig_IncomingTLS(t *testing.T) {
 	conf := &Config{
 		VerifyIncoming: true,
-		CAFile:         "../test/ca/root.cer",
-		CertFile:       "../test/key/ourdomain.cer",
-		KeyFile:        "../test/key/ourdomain.key",
+		CAFile:         "../../../../../../test/ca/root.cer",
+		CertFile:       "../../../../../../test/key/ourdomain.cer",
+		KeyFile:        "../../../../../../test/key/ourdomain.key",
 	}
 	tlsC, err := conf.IncomingTLSConfig()
 	if err != nil {
@@ -412,8 +412,8 @@ func TestConfig_IncomingTLS(t *testing.T
 func TestConfig_IncomingTLS_MissingCA(t *testing.T) {
 	conf := &Config{
 		VerifyIncoming: true,
-		CertFile:       "../test/key/ourdomain.cer",
-		KeyFile:        "../test/key/ourdomain.key",
+		CertFile:       "../../../../../../test/key/ourdomain.cer",
+		KeyFile:        "../../../../../../test/key/ourdomain.key",
 	}
 	_, err := conf.IncomingTLSConfig()
 	if err == nil {
@@ -424,7 +424,7 @@ func TestConfig_IncomingTLS_MissingCA(t
 func TestConfig_IncomingTLS_MissingKey(t *testing.T) {
 	conf := &Config{
 		VerifyIncoming: true,
-		CAFile:         "../test/ca/root.cer",
+		CAFile:         "../../../../../../test/ca/root.cer",
 	}
 	_, err := conf.IncomingTLSConfig()
 	if err == nil {
Index: consul/consul/server_test.go
===================================================================
--- consul.orig/consul/server_test.go
+++ consul/consul/server_test.go
@@ -30,9 +30,9 @@ func tmpDir(t *testing.T) string {
 }
 
 func configureTLS(config *Config) {
-	config.CAFile = "../test/ca/root.cer"
-	config.CertFile = "../test/key/ourdomain.cer"
-	config.KeyFile = "../test/key/ourdomain.key"
+	config.CAFile = "../../../../../../test/ca/root.cer"
+	config.CertFile = "../../../../../../test/key/ourdomain.cer"
+	config.KeyFile = "../../../../../../test/key/ourdomain.key"
 }
 
 func testServerConfig(t *testing.T, NodeName string) (string, *Config) {
